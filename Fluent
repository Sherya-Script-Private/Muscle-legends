-- ===========================
-- Sherya Script | Galaxy Hub
-- Migración completa a Fluent Renewed (by Isabella)
-- ===========================

-- Librerías principales (Fluent Renewed)
local Library = loadstring(game:HttpGetAsync("https://github.com/ActualMasterOogway/Fluent-Renewed/releases/latest/download/Fluent.luau"))()
local SaveManager = loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/ActualMasterOogway/Fluent-Renewed/master/Addons/SaveManager.luau"))()
local InterfaceManager = loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/ActualMasterOogway/Fluent-Renewed/master/Addons/InterfaceManager.luau"))()

-- Servicios
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local StarterGui = game:GetService("StarterGui")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")

-- ===========================
-- Ventana principal
-- ===========================
local Window = Library:CreateWindow({
    Title = "Sherya Script | Galaxy Hub",
    SubTitle = "By Isabella",
    TabWidth = 160,
    Size = UDim2.fromOffset(500, 800),
    Acrylic = true,
    Theme = "Amethyst Dark",
    MinimizeKey = Enum.KeyCode.RightControl
})

-- ===========================
-- Tabs
-- ===========================
local Tabs = {
    Main       = Window:CreateTab({ Title = "Main",       Icon = "house" }),
    Farm       = Window:CreateTab({ Title = "Farm",       Icon = "wheat" }),
    Misc       = Window:CreateTab({ Title = "Misc",       Icon = "settings" }),
    Pets       = Window:CreateTab({ Title = "Pets",       Icon = "heart" }),
    Stats      = Window:CreateTab({ Title = "Stats",      Icon = "trending-up" }),
    Calculator = Window:CreateTab({ Title = "Calculator", Icon = "calculator" }),
    Killer     = Window:CreateTab({ Title = "Killer",     Icon = "sword" }),
    Teleport   = Window:CreateTab({ Title = "Teleport",   Icon = "zap" }),
    Credits    = Window:CreateTab({ Title = "Credits",    Icon = "users" })
}

-- Helpers
local function notify(t, m, d)
    pcall(function()
        StarterGui:SetCore("SendNotification", { Title = t, Text = m, Duration = d or 3 })
    end)
end

local function safeChar()
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    return char
end

-- ===========================
-- MAIN → Auto Brawls + Anti-AFK GUI
-- ===========================
local Brawl = Tabs.Main:CreateGroup("  Auto Brawls")

-- God Mode Brawl (spam join)
do
    local running = false
    Brawl:AddToggle("God Mode Brawl", {
        Flag = "GodModeBrawl",
        Callback = function(state)
            running = state
            if state then
                task.spawn(function()
                    while running do
                        ReplicatedStorage.rEvents.brawlEvent:FireServer("joinBrawl")
                        task.wait()
                    end
                end)
            end
        end
    })
end

-- Auto Win Brawls (equip punch + atacar jugadores válidos)
do
    local function equipPunch()
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("Punch") then return true end
        local bp = LocalPlayer:FindFirstChild("Backpack")
        if not bp then return false end
        for _,tool in ipairs(bp:GetChildren()) do
            if tool:IsA("Tool") and tool.Name == "Punch" then
                tool.Parent = LocalPlayer.Character
                return true
            end
        end
        return false
    end

    local function isValidTarget(plr)
        if not plr or plr == LocalPlayer then return false end
        local ch = plr.Character
        if not ch then return false end
        local hum = ch:FindFirstChildOfClass("Humanoid")
        if not hum or hum.Health <= 0 then return false end
        if _G.whitelistedPlayers and table.find(_G.whitelistedPlayers, plr.Name) then return false end
        return true
    end

    local loop = false
    Brawl:AddToggle("Auto Win Brawls", {
        Flag = "AutoWinBrawl",
        Callback = function(state)
            loop = state
            if state then
                task.spawn(function()
                    while loop do
                        equipPunch()
                        local char = LocalPlayer.Character
                        local r = char and char:FindFirstChild("RightHand")
                        local l = char and char:FindFirstChild("LeftHand")
                        if r and l then
                            for _, p in ipairs(Players:GetPlayers()) do
                                if isValidTarget(p) then
                                    local rp = p.Character and p.Character:FindFirstChild("HumanoidRootPart")
                                    if rp then
                                        firetouchinterest(r, rp, 1)
                                        firetouchinterest(l, rp, 1)
                                        firetouchinterest(r, rp, 0)
                                        firetouchinterest(l, rp, 0)
                                    end
                                end
                            end
                        end
                        task.wait(0.05)
                    end
                end)
            end
        end
    })
end

-- MAIN → OP Things (Anti-AFK GUI + Optimizaciones)
local OP = Tabs.Main:CreateGroup("  OP Things")
do
    local VirtualUser = game:GetService("VirtualUser")
    local antiAFKConnection, antiAFKActive, sheryaGUI, sessionStartTime

    local function createSheryaGUI()
        if sheryaGUI then sheryaGUI:Destroy() end
        sheryaGUI = Instance.new("ScreenGui")
        sheryaGUI.Name = "SheryaAntiAFK"
        sheryaGUI.ResetOnSpawn = false
        sheryaGUI.Parent = LocalPlayer:WaitForChild("PlayerGui")

        local f = Instance.new("Frame")
        f.BackgroundColor3 = Color3.fromRGB(75,0,130)
        f.Size = UDim2.new(0, 220, 0, 90)
        f.Position = UDim2.new(0, 10, 0, 100)
        f.Active, f.Draggable = true, true
        f.Parent = sheryaGUI

        local title = Instance.new("TextLabel")
        title.BackgroundTransparency = 1
        title.Size = UDim2.new(1,0,0,22)
        title.Text = "Sherya Anti-AFK"
        title.Font = Enum.Font.SourceSansBold
        title.TextScaled = true
        title.TextColor3 = Color3.fromRGB(255,255,255)
        title.Parent = f

        local info = Instance.new("TextLabel")
        info.BackgroundTransparency = 1
        info.Position = UDim2.new(0,0,0,24)
        info.Size = UDim2.new(1,0,1,-24)
        info.Text = "Ping/FPS/Session..."
        info.Font = Enum.Font.SourceSans
        info.TextScaled = true
        info.TextColor3 = Color3.fromRGB(255,255,255)
        info.Parent = f

        -- mini loop de stats
        task.spawn(function()
            while sheryaGUI and sheryaGUI.Parent do
                local ping = math.floor(game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue())
                local fps = math.floor(1/(RunService.RenderStepped:Wait() or 0.016))
                local elapsed = math.floor((tick() - (sessionStartTime or tick()))/60)
                info.Text = string.format("Ping: %dms  FPS: %d\nSession: %dm", ping, fps, elapsed)
            end
        end)
    end

    local function startAntiAFK()
        if antiAFKConnection then antiAFKConnection:Disconnect() end
        antiAFKConnection = LocalPlayer.Idled:Connect(function()
            VirtualUser:CaptureController()
            VirtualUser:ClickButton2(Vector2.new())
        end)

        -- Optimizaciones
        pcall(function()
            settings().Rendering.QualityLevel = "Level01"
            workspace.StreamingEnabled = true
            workspace.StreamingTargetRadius = 100
        end)
    end

    local function stopAntiAFK()
        if antiAFKConnection then antiAFKConnection:Disconnect() antiAFKConnection = nil end
        if sheryaGUI then sheryaGUI:Destroy() sheryaGUI = nil end
    end

    OP:AddButton("Anti AFK GUI", function()
        antiAFKActive = not antiAFKActive
        if antiAFKActive then
            sessionStartTime = tick()
            createSheryaGUI()
            startAntiAFK()
            notify("Sherya Script","Anti-AFK activado! GUI visible.",5)
        else
            stopAntiAFK()
            notify("Sherya Script","Anti-AFK desactivado! GUI cerrada.",5)
        end
    end)

    OP:AddLabel("Anti-AFK Features:")
    OP:AddLabel("• Previene desconexión por inactividad")
    OP:AddLabel("• Muestra Ping, FPS y tiempo de sesión")
    OP:AddLabel("• GUI morada movible + optimización")
end

-- ===========================
-- FARM → Auto Rocks
-- ===========================
local FarmRocks = Tabs.Farm:CreateGroup("  Auto Rocks")

do
    local function gettool()
        for _, v in pairs(LocalPlayer.Backpack:GetChildren()) do
            if v.Name == "Punch" and safeChar():FindFirstChild("Humanoid") then
                safeChar().Humanoid:EquipTool(v)
            end
        end
        LocalPlayer.muscleEvent:FireServer("punch","leftHand")
        LocalPlayer.muscleEvent:FireServer("punch","rightHand")
    end

    local function rockLoop(required, name)
        local on = true
        task.spawn(function()
            while on do
                task.wait()
                if LocalPlayer.Durability.Value >= required then
                    for _,v in pairs(workspace.machinesFolder:GetDescendants()) do
                        if v.Name == "neededDurability" and v.Value == required then
                            local ch = safeChar()
                            local lh, rh = ch:FindFirstChild("LeftHand"), ch:FindFirstChild("RightHand")
                            if lh and rh and v.Parent:FindFirstChild("Rock") then
                                firetouchinterest(v.Parent.Rock, rh, 0)
                                firetouchinterest(v.Parent.Rock, rh, 1)
                                firetouchinterest(v.Parent.Rock, lh, 0)
                                firetouchinterest(v.Parent.Rock, lh, 1)
                                gettool()
                            end
                        end
                    end
                end
            end
        end)
        return function() on = false end
    end

    local stopTiny, stopEternal, stopLegend, stopMK = nil,nil,nil,nil

    FarmRocks:AddToggle("Tiny Rock", {
        Flag="TinyRock",
        Callback=function(b)
            if b then stopTiny = rockLoop(0, "Tiny Island Rock") else if stopTiny then stopTiny() end end
        end
    })

    FarmRocks:AddToggle("Eternal Rock", {
        Flag="EternalRock",
        Callback=function(b)
            if b then stopEternal = rockLoop(750000, "Eternal Gym Rock") else if stopEternal then stopEternal() end end
        end
    })

    FarmRocks:AddToggle("Legend Rock", {
        Flag="LegendRock",
        Callback=function(b)
            if b then stopLegend = rockLoop(1000000, "Legend Gym Rock") else if stopLegend then stopLegend() end end
        end
    })

    FarmRocks:AddToggle("Muscle King Rock", {
        Flag="MuscleKingRock",
        Callback=function(b)
            if b then stopMK = rockLoop(5000000, "Muscle King Gym Rock") else if stopMK then stopMK() end end
        end
    })
end

-- ===========================
-- FARM → OP Farm Tools (texto guía)
-- ===========================
local OPTools = Tabs.Farm:CreateGroup("  OP Farm Tools")
OPTools:AddLabel("Instructions:")
OPTools:AddLabel("• Equipa Pushups/Situps/Handstands/Weight y Punch + Rock para farm dual")
OPTools:AddLabel("Instrucciones (ES): Equipa herramienta + Punch + roca")

-- ===========================
-- FARM → Auto Rebirths
-- ===========================
local Rebirths = Tabs.Farm:CreateGroup("  Auto Rebirths")
do
    local targetRebirthValue = 1
    Rebirths:AddInput("Rebirth Target", {
        Numeric = true,
        Placeholder = "Ej: 100",
        Callback = function(text)
            local v = tonumber(text)
            if v and v > 0 then
                targetRebirthValue = v
                notify("Objetivo Actualizado","Nuevo objetivo: "..tostring(v).." renacimientos")
            else
                notify("Entrada Inválida","Ingresa un número válido > 0",4)
            end
        end
    })

    local targetLoop, infiniteLoop = false, false
    local targetToggle, infiniteToggle

    targetToggle = Rebirths:AddToggle("Auto Rebirth Target", {
        Flag="AutoRebirthTarget",
        Callback=function(on)
            targetLoop = on
            if on then
                if infiniteLoop and infiniteToggle then infiniteToggle:Set(false) infiniteLoop=false end
                task.spawn(function()
                    while targetLoop do
                        local cur = LocalPlayer.leaderstats.Rebirths.Value
                        if cur >= targetRebirthValue then
                            targetToggle:Set(false)
                            targetLoop = false
                            notify("¡Objetivo Alcanzado!","Has alcanzado "..tostring(targetRebirthValue).." renacimientos",5)
                            break
                        end
                        ReplicatedStorage.rEvents.rebirthRemote:InvokeServer("rebirthRequest")
                        task.wait(0.1)
                    end
                end)
            end
        end
    })

    infiniteToggle = Rebirths:AddToggle("Auto Rebirth (Infinite)", {
        Flag="AutoRebirthInfinite",
        Callback=function(on)
            infiniteLoop = on
            if on then
                if targetLoop and targetToggle then targetToggle:Set(false) targetLoop=false end
                task.spawn(function()
                    while infiniteLoop do
                        ReplicatedStorage.rEvents.rebirthRemote:InvokeServer("rebirthRequest")
                        task.wait(0.1)
                    end
                end)
            end
        end
    })

    Rebirths:AddToggle("Auto Size 1", {
        Flag="AutoSizeOne",
        Callback=function(on)
            if on then
                task.spawn(function()
                    while Library.Flags.AutoSizeOne do
                        ReplicatedStorage.rEvents.changeSpeedSizeRemote:InvokeServer("changeSize",1)
                        task.wait()
                    end
                end)
            end
        end
    })

    Rebirths:AddToggle("Auto Teleport to Muscle King", {
        Flag="AutoTPMK",
        Callback=function(on)
            if on then
                task.spawn(function()
                    while Library.Flags.AutoTPMK do
                        local ch = safeChar()
                        ch:MoveTo(Vector3.new(-8646, 17, -5738))
                        task.wait()
                    end
                end)
            end
        end
    })
end

-- ===========================
-- GIFTER (Eggs/Shakes) – Farm
-- ===========================
local Gift = Tabs.Farm:CreateGroup("  Gifts / Snacks")
do
    Gift:AddLabel("Egg Gifter:")
    local proteinEggLabel = Gift:AddLabel("Protein Eggs: 0")
    local tropicalShakeLabel = Gift:AddLabel("Tropical Shakes: 0")

    local function updateItemCount()
        local proteinEggCount, tropicalShakeCount = 0,0
        local bp = LocalPlayer:FindFirstChild("Backpack")
        if bp then
            for _,it in ipairs(bp:GetChildren()) do
                if it.Name == "Protein Egg" then proteinEggCount += 1
                elseif it.Name == "Tropical Shake" then tropicalShakeCount += 1 end
            end
        end
        proteinEggLabel.Text = "Protein Eggs: "..proteinEggCount
        tropicalShakeLabel.Text = "Tropical Shakes: "..tropicalShakeCount
    end
    task.spawn(function()
        while true do updateItemCount() task.wait(0.25) end
    end)

    local selectedPlayerEgg, eggCount = nil, 0
    local ddEgg = Gift:AddDropdown("Choose Player", {Values={}, Default=nil}, function(name)
        selectedPlayerEgg = Players:FindFirstChild(name)
    end)
    local function refreshPlayers(drop)
        local names = {}
        for _,p in ipairs(Players:GetPlayers()) do
            if p ~= LocalPlayer then table.insert(names, p.Name) end
        end
        drop:SetValues(names)
    end
    refreshPlayers(ddEgg)
    Players.PlayerAdded:Connect(function() refreshPlayers(ddEgg) end)
    Players.PlayerRemoving:Connect(function() refreshPlayers(ddEgg) end)

    Gift:AddInput("Amount (Eggs)", {Numeric=true}, function(t) eggCount = tonumber(t) or 0 end)
    Gift:AddButton("Start Gifting Eggs", function()
        if selectedPlayerEgg and eggCount>0 then
            for i=1,eggCount do
                local args = {"giftRequest", selectedPlayerEgg, LocalPlayer.consumablesFolder:FindFirstChild("Protein Egg")}
                ReplicatedStorage.rEvents.giftRemote:InvokeServer(unpack(args))
            end
        end
    end)

    local selectedPlayerShake, shakeCount = nil, 0
    local ddShake = Gift:AddDropdown("Choose Player (Shakes)", {Values={}, Default=nil}, function(name)
        selectedPlayerShake = Players:FindFirstChild(name)
    end)
    refreshPlayers(ddShake)
    Gift:AddInput("Amount (Shakes)", {Numeric=true}, function(t) shakeCount = tonumber(t) or 0 end)
    Gift:AddButton("Start Gifting Shakes", function()
        if selectedPlayerShake and shakeCount>0 then
            for i=1,shakeCount do
                local args = {"giftRequest", selectedPlayerShake, LocalPlayer.consumablesFolder:FindFirstChild("Tropical Shake")}
                ReplicatedStorage.rEvents.giftRemote:InvokeServer(unpack(args))
            end
        end
    end)

    Gift:AddLabel("")
    Gift:AddLabel("Note: Jungle Captain Obligatorio")
end

-- ===========================
-- MISC
-- ===========================
local Misc1 = Tabs.Misc:CreateGroup("  Misc 1 (Size/Speed)")
do
    local sizeValue, speedValue = 2, 16
    local autoSizeEnabled, autoSpeedEnabled = false, false
    local autoSpeedConn

    Misc1:AddInput("Auto Size", {Numeric=true, Placeholder="2"}, function(text)
        sizeValue = tonumber(text) or 2
        if autoSizeEnabled then
            pcall(function()
                ReplicatedStorage.rEvents.changeSpeedSizeRemote:InvokeServer("changeSize", sizeValue)
            end)
        end
    end)

    Misc1:AddToggle("Auto Set Size", {Flag="AutoSetSize"}, function(on)
        autoSizeEnabled = on
        if on then
            task.spawn(function()
                while autoSizeEnabled do
                    pcall(function()
                        ReplicatedStorage.rEvents.changeSpeedSizeRemote:InvokeServer("changeSize", sizeValue)
                    end)
                    task.wait(0.1)
                end
            end)
        end
    end)

    Misc1:AddInput("Auto Speed", {Numeric=true, Placeholder="16"}, function(text)
        speedValue = tonumber(text) or 16
        local ch = LocalPlayer.Character
        if ch and ch:FindFirstChildOfClass("Humanoid") then
            ch.Humanoid.WalkSpeed = speedValue
        end
    end)

    Misc1:AddToggle("Auto Set Speed", {Flag="AutoSetSpeed"}, function(on)
        autoSpeedEnabled = on
        local ch = LocalPlayer.Character
        if on then
            if ch and ch:FindFirstChildOfClass("Humanoid") then ch.Humanoid.WalkSpeed = speedValue end
            if autoSpeedConn then autoSpeedConn:Disconnect() end
            autoSpeedConn = LocalPlayer.CharacterAdded:Connect(function(c)
                local h = c:WaitForChild("Humanoid")
                if h then h.WalkSpeed = speedValue end
            end)
        else
            if autoSpeedConn then autoSpeedConn:Disconnect() autoSpeedConn=nil end
        end
    end)
end

local Misc2 = Tabs.Misc:CreateGroup("  Misc 2 (Hubs)")
Misc2:AddButton("Infinite Yield", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()
end)
Misc2:AddButton("GhostX Hub", function()
    loadstring(game:HttpGet("https://scriptblox.com/raw/Universal-Script-GhostX-Hub-7158"))()
end)

local Misc3 = Tabs.Misc:CreateGroup("  Misc 3 (Movement/Time)")
do
    local noclipEnabled, noclipConnection
    local function toggleNoclip(enabled)
        local ch = safeChar()
        if enabled then
            noclipConnection = RunService.Stepped:Connect(function()
                for _,p in ipairs(ch:GetDescendants()) do
                    if p:IsA("BasePart") then p.CanCollide = false end
                end
            end)
        else
            if noclipConnection then noclipConnection:Disconnect() noclipConnection=nil end
        end
    end

    local infiniteJumpEnabled
    local function toggleInfiniteJump(en)
        infiniteJumpEnabled = en
        if en then
            game:GetService("UserInputService").JumpRequest:Connect(function()
                if infiniteJumpEnabled then
                    local h = safeChar():FindFirstChildOfClass("Humanoid")
                    if h then h:ChangeState(Enum.HumanoidStateType.Jumping) end
                end
            end)
        end
    end

    Misc3:AddToggle("No-Clip", function(b) noclipEnabled=b toggleNoclip(b) end)
    Misc3:AddToggle("Infinite Jump", function(b) toggleInfiniteJump(b) end)

    local timeDD = Misc3:AddDropdown("Change Time", {Values={"Night","Day","Midnight"}, Default="Day"}, function(selection)
        if selection == "Night" then Lighting.ClockTime = 0
        elseif selection == "Day" then Lighting.ClockTime = 12
        elseif selection == "Midnight" then Lighting.ClockTime = 6 end
    end)
end

local Misc4 = Tabs.Misc:CreateGroup("  Misc 4 (Server)")
Misc4:AddButton("Rejoin Server", function()
    local TeleportService = game:GetService("TeleportService")
    local ok = pcall(function()
        TeleportService:TeleportToPlaceInstance(game.PlaceId, nil, LocalPlayer)
    end)
    if not ok then TeleportService:Teleport(game.PlaceId, LocalPlayer) end
end)

local Misc5 = Tabs.Misc:CreateGroup("  Misc 5 (QoL)")
Misc5:AddButton("Remove Portals", function()
    for _,d in pairs(game:GetDescendants()) do
        if d.Name == "RobloxForwardPortals" then d:Destroy() end
    end
    if _G.AdRemovalConnection then _G.AdRemovalConnection:Disconnect() end
    _G.AdRemovalConnection = game.DescendantAdded:Connect(function(desc)
        if desc.Name == "RobloxForwardPortals" then desc:Destroy() end
    end)
    notify("Anuncios Eliminados","Portales publicitarios removidos",3)
end)

Misc5:AddToggle("Auto Spin Wheel", function(b)
    _G.AutoSpinWheel = b
    if b then
        task.spawn(function()
            while _G.AutoSpinWheel do
                ReplicatedStorage.rEvents.openFortuneWheelRemote:InvokeServer(
                    "openFortuneWheel",
                    ReplicatedStorage.fortuneWheelChances["Fortune Wheel"]
                )
                task.wait(1)
            end
        end)
    end
end)

-- ===========================
-- PETS & AURAS
-- ===========================
local Pets = Tabs.Pets:CreateGroup("  Pets & Auras")
do
    -- Construcción de listas (idéntico a tu dataset “crystalData”, abreviado aquí)
    -- Si ya tienes crystalData en el ambiente, puedes reusar.
    local crystalData = {} -- coloca aquí tu tabla completa si la usabas externamente

    local function findCrystalForItem(itemName)
        for crystalName, pets in pairs(crystalData) do
            for _, pet in ipairs(pets) do
                if pet.name == itemName then
                    return crystalName
                end
            end
        end
        return nil
    end

    local selectedPet, selectedAura = "", ""

    Pets:AddLabel("=== Pet & Aura Auto Buy ===")

    local petDropdown = Pets:AddDropdown("Select Pet", {Values={}, Multi=false}, function(text)
        selectedPet = text
        local crystal = findCrystalForItem(text)
        print("Pet selected:", text, "Found in:", crystal or "Unknown")
    end)

    local auraDropdown = Pets:AddDropdown("Select Aura", {Values={}, Multi=false}, function(text)
        selectedAura = text
        print("Aura selected:", text)
    end)

    -- (Opcional) Puedes llenar petDropdown/auraDropdown con tus listas completas aquí

    Pets:AddToggle("Auto Buy Pet", function(on)
        _G.AutoBuyPet = on
        if on then
            if selectedPet == "" then return print("Select a pet first!") end
            local petName = selectedPet:match("^(.-)%s*%(") or selectedPet
            local crystal = findCrystalForItem(petName)
            print("Auto buy pet for:", petName, "from", crystal or "Unknown")
            task.spawn(function()
                while _G.AutoBuyPet and selectedPet ~= "" do
                    local petToBuy = ReplicatedStorage.cPetShopFolder:FindFirstChild(petName)
                    if petToBuy then ReplicatedStorage.cPetShopRemote:InvokeServer(petToBuy) end
                    task.wait(1)
                end
            end)
        end
    end)

    Pets:AddToggle("Auto Buy Aura", function(on)
        _G.AutoBuyAura = on
        if on then
            if selectedAura == "" then return print("Select an aura first!") end
            local auraName = selectedAura:match("^(.-)%s*%(") or selectedAura
            local crystal = findCrystalForItem(auraName)
            print("Auto buy aura for:", auraName, "from", crystal or "Unknown")
            task.spawn(function()
                while _G.AutoBuyAura and selectedAura ~= "" do
                    local auraToBuy = ReplicatedStorage.cPetShopFolder:FindFirstChild(auraName)
                    if auraToBuy then ReplicatedStorage.cPetShopRemote:InvokeServer(auraToBuy) end
                    task.wait(1)
                end
            end)
        end
    end)

    Pets:AddLabel("=== Ultimate Upgrades ===")
    local ultimateOptions = {
        "+1 Daily Spin","+1 Pet Slot","+10 Item Capacity","+5% Rep Speed",
        "Demon Damage","Galaxy Gains","Golden Rebirth","Jungle Swift",
        "Muscle Mind","x2 Chest Rewards","x2 Quest Rewards"
    }
    local selectedUltimate = ""
    Pets:AddDropdown("Select Ultimate", {Values=ultimateOptions, Default=nil}, function(t) selectedUltimate=t end)

    Pets:AddToggle("Auto Upgrade Ultimate", function(on)
        _G.AutoUpgradeUltimate = on
        if on then
            if selectedUltimate == "" then return end
            task.spawn(function()
                while _G.AutoUpgradeUltimate and selectedUltimate ~= "" do
                    ReplicatedStorage.rEvents.ultimatesRemote:InvokeServer("upgradeUltimate", selectedUltimate)
                    task.wait(1)
                end
            end)
        end
    end)
end

-- ===========================
-- STATS (visor en vivo simplificado)
-- ===========================
local Stats = Tabs.Stats:CreateGroup("  Player Stats")
do
    local nameLbl = Stats:AddLabel("Name: " .. LocalPlayer.DisplayName)
    local userLbl = Stats:AddLabel("Username: " .. LocalPlayer.Name)
    local function withCommas(n)
        local s = tostring(n)
        while true do
            s, k = s:gsub("^(-?%d+)(%d%d%d)", "%1,%2")
            if k == 0 then break end
        end
        return s
    end

    local function update()
        local l = LocalPlayer:FindFirstChild("leaderstats")
        if not l then return end
        for _, stat in ipairs({"Strength","Durability","Rebirths","Kills","Brawls"}) do
            local obj = l:FindFirstChild(stat) or LocalPlayer:FindFirstChild(stat)
            local text = stat..": 0"
            if obj then text = stat..": "..withCommas(obj.Value) end
            Stats:AddLabel(text)
        end
    end
    task.spawn(function()
        while true do update() task.wait(1) end
    end)
end

-- ===========================
-- CALCULATOR EXTENDIDO
-- ===========================
local Calc = Tabs.Calculator:CreateGroup("  Calculators")
do
    local function makeCalc(name, getter)
        local title = Calc:AddLabel(name.." Calculator")
        local status = Calc:AddLabel("Status: Presiona Start para comenzar")
        local perMin = Calc:AddLabel("Per minute: 0")
        local perHour = Calc:AddLabel("Per hour: 0")

        local active, startTime, startValue = false, 0, 0

        Calc:AddButton("Start "..name, function()
            active = true
            startTime = tick()
            startValue = getter()
            status.Text = "Status:  Iniciado - Calculando..."
            notify("Calculator", name.." iniciado!")
        end)

        Calc:AddButton("Stop "..name, function()
            active = false
            status.Text = "Status:  Detenido"
            notify("Calculator", name.." detenido!")
        end)

        task.spawn(function()
            while true do
                if active then
                    local elapsed = math.max(1, tick() - startTime)
                    local diff = getter() - startValue
                    perMin.Text = string.format("Per minute: %0.2f", diff / (elapsed/60))
                    perHour.Text = string.format("Per hour: %0.2f", diff / (elapsed/3600))
                end
                task.wait(1)
            end
        end)

        return {
            reset=function()
                active=false; startTime=0; startValue=0;
                status.Text = "Status: Presiona Start para comenzar"
            end
        }
    end

    local ls = function(n) local ls = LocalPlayer:FindFirstChild("leaderstats"); local o=ls and ls:FindFirstChild(n); return o and o.Value or 0 end

    local cStrength = makeCalc("Strength", function() return ls("Strength") end)
    local cDurab   = makeCalc("Durability", function() return ls("Durability") end)
    local cReb     = makeCalc("Rebirths", function() return ls("Rebirths") end)
    local cKills   = makeCalc("Kills", function() return ls("Kills") end)
    local cBrawls  = makeCalc("Brawls", function() return ls("Brawls") end)

    Calc:AddButton("Reset All Calculators", function()
        cStrength.reset(); cDurab.reset(); cReb.reset(); cKills.reset(); cBrawls.reset()
        notify("Calculator","¡Todos los calculators han sido reiniciados!")
    end)

    Calc:AddLabel("Instrucciones:")
    Calc:AddLabel("1. Presiona 'Start' en la stat que quieras medir")
    Calc:AddLabel("2. Espera 1 minuto para ver los cálculos")
    Calc:AddLabel("3. Los valores se actualizan automáticamente")
    Calc:AddLabel("4. Puedes usar múltiples calculators a la vez")
end

-- ===========================
-- KILLER
-- ===========================
local Kill = Tabs.Killer:CreateGroup("  Kill Aura / Karma")
do
    _G.whitelistedPlayers = _G.whitelistedPlayers or {}
    _G.blacklistedPlayers = _G.blacklistedPlayers or {}

    -- Auto Good Karma
    Kill:AddToggle("Auto Good Karma", function(on)
        local loop = on
        if on then
            task.spawn(function()
                while loop do
                    local ch = LocalPlayer.Character
                    local rh = ch and ch:FindFirstChild("RightHand")
                    local lh = ch and ch:FindFirstChild("LeftHand")
                    if ch and rh and lh then
                        for _,t in ipairs(Players:GetPlayers()) do
                            if t ~= LocalPlayer then
                                local ek = t:FindFirstChild("evilKarma")
                                local gk = t:FindFirstChild("goodKarma")
                                if ek and gk and ek:IsA("IntValue") and gk:IsA("IntValue") and ek.Value > gk.Value then
                                    local rp = t.Character and t.Character:FindFirstChild("HumanoidRootPart")
                                    if rp then
                                        firetouchinterest(rh,rp,1)
                                        firetouchinterest(lh,rp,1)
                                        firetouchinterest(rh,rp,0)
                                        firetouchinterest(lh,rp,0)
                                    end
                                end
                            end
                        end
                    end
                    task.wait(0.01)
                end
            end)
        end
    end)

    -- Auto Bad Karma
    Kill:AddToggle("Auto Bad Karma", function(on)
        local loop = on
        if on then
            task.spawn(function()
                while loop do
                    local ch = LocalPlayer.Character
                    local rh = ch and ch:FindFirstChild("RightHand")
                    local lh = ch and ch:FindFirstChild("LeftHand")
                    if ch and rh and lh then
                        for _,t in ipairs(Players:GetPlayers()) do
                            if t ~= LocalPlayer then
                                local ek = t:FindFirstChild("evilKarma")
                                local gk = t:FindFirstChild("goodKarma")
                                if ek and gk and ek:IsA("IntValue") and gk:IsA("IntValue") and gk.Value > ek.Value then
                                    local rp = t.Character and t.Character:FindFirstChild("HumanoidRootPart")
                                    if rp then
                                        firetouchinterest(rh,rp,1)
                                        firetouchinterest(lh,rp,1)
                                        firetouchinterest(rh,rp,0)
                                        firetouchinterest(lh,rp,0)
                                    end
                                end
                            end
                        end
                    end
                    task.wait(0.01)
                end
            end)
        end
    end)

    -- Auto Punch (attackTime=0 y activar)
    Kill:AddToggle("Auto Punch", function(on)
        _G.autoPunchActive = on
        if on then
            task.spawn(function()
                while _G.autoPunchActive do
                    local punch = LocalPlayer.Backpack:FindFirstChild("Punch")
                    if punch then
                        punch.Parent = LocalPlayer.Character
                        if punch:FindFirstChild("attackTime") then
                            punch.attackTime.Value = 0
                        end
                    end
                    task.wait()
                end
            end)
            task.spawn(function()
                while _G.autoPunchActive do
                    local punch = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Punch")
                    if punch then punch:Activate() end
                    task.wait()
                end
            end)
        else
            local punch = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Punch")
            if punch then punch.Parent = LocalPlayer.Backpack end
        end
    end)

    -- Kill Counter UI
    Kill:AddButton("Kill Counter UI", function()
        -- se conserva la misma UI básica
        local killsGui = LocalPlayer.PlayerGui:FindFirstChild("KillsGui")
        if killsGui then
            killsGui.Enabled = not killsGui.Enabled
            return
        end
        killsGui = Instance.new("ScreenGui")
        killsGui.Name = "KillsGui"
        killsGui.ResetOnSpawn = false
        killsGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

        local frame = Instance.new("Frame")
        frame.Size = UDim2.new(0,180,0,55)
        frame.Position = UDim2.new(0.5, -90, 0, 60)
        frame.BackgroundColor3 = Color3.fromRGB(75,0,130)
        frame.Active = true; frame.Draggable = true
        frame.Parent = killsGui

        local title = Instance.new("TextLabel")
        title.Size = UDim2.new(1,0,0,20)
        title.BackgroundTransparency = 1
        title.Text = "Sherya Script"
        title.TextColor3 = Color3.fromRGB(255,255,255)
        title.Font = Enum.Font.SourceSansBold
        title.TextScaled = true
        title.Parent = frame

        local killsLabel = Instance.new("TextLabel")
        killsLabel.Size = UDim2.new(1,0,0,35)
        killsLabel.Position = UDim2.new(0,0,0,20)
        killsLabel.BackgroundTransparency = 1
        killsLabel.TextColor3 = Color3.fromRGB(255,255,255)
        killsLabel.TextScaled = true
        killsLabel.Font = Enum.Font.SourceSansBold
        killsLabel.Parent = frame

        task.spawn(function()
            while killsGui and killsGui.Parent do
                local kills = LocalPlayer:FindFirstChild("leaderstats") and LocalPlayer.leaderstats:FindFirstChild("Kills")
                killsLabel.Text = "Kills: " .. tostring(kills and kills.Value or 0)
                task.wait(0.2)
            end
        end)
    end)

    -- Punch Boost Scripts (URLs)
    Kill:AddToggle("Punch Boost Scripts", function(on)
        _G.PunchBoostActive = on
        if on then
            local urls = {
                "https://raw.githubusercontent.com/Sherya-Script-Private/Muerto/refs/heads/main/Punch1",
                "https://raw.githubusercontent.com/Sherya-Script-Private/Muerto/refs/heads/main/puch2",
                "https://raw.githubusercontent.com/Sherya-Script-Private/Muerto/refs/heads/main/punch3",
                "https://raw.githubusercontent.com/Sherya-Script-Private/Muerto/refs/heads/main/punch4",
                "https://raw.githubusercontent.com/Sherya-Script-Private/Muerto/refs/heads/main/punch5",
                "https://raw.githubusercontent.com/Sherya-Script-Private/Muerto/refs/heads/main/punch6"
            }
            task.spawn(function()
                for i,url in ipairs(urls) do
                    if not _G.PunchBoostActive then break end
                    local s,err = pcall(function() loadstring(game:HttpGet(url, true))() end)
                    if not s then warn("Error cargando script "..i..": "..tostring(err)) end
                    task.wait(0.5)
                end
            end)
        end
    end)

    -- Whitelist / Killlist UI mínimo
    local whitelistLabel = Kill:AddLabel("Whitelist: None")
    local blacklistLabel = Kill:AddLabel("Killlist: None")

    local function refreshLists()
        whitelistLabel.Text = (#_G.whitelistedPlayers==0) and "Whitelist: None" or ("Whitelist: "..table.concat(_G.whitelistedPlayers,", "))
        blacklistLabel.Text = (#_G.blacklistedPlayers==0) and "Killlist: None" or ("Killlist: "..table.concat(_G.blacklistedPlayers,", "))
    end

    Kill:AddButton("Clear Whitelist", function() _G.whitelistedPlayers = {} end)
    Kill:AddButton("Clear Blacklist", function() _G.blacklistedPlayers = {} end)

    local ddWL = Kill:AddDropdown("Add to Whitelist", {Values={}, Default=nil}, function(sel)
        local name = sel
        if name and not table.find(_G.whitelistedPlayers, name) then table.insert(_G.whitelistedPlayers, name) end
    end)
    local ddBL = Kill:AddDropdown("Add to Killlist", {Values={}, Default=nil}, function(sel)
        local name = sel
        if name and not table.find(_G.blacklistedPlayers, name) then table.insert(_G.blacklistedPlayers, name) end
    end)
    local function refreshPlayersForKill()
        local names={}
        for _,p in ipairs(Players:GetPlayers()) do if p~=LocalPlayer then table.insert(names,p.Name) end end
        ddWL:SetValues(names); ddBL:SetValues(names)
    end
    refreshPlayersForKill()
    task.spawn(function() while true do refreshLists() task.wait(0.2) end end)
    Players.PlayerAdded:Connect(refreshPlayersForKill)
    Players.PlayerRemoving:Connect(refreshPlayersForKill)

    -- Remove Punch Anim
    Kill:AddButton("Remove Punch Anim", function()
        local blocked = { ["rbxassetid://3638729053"]=true, ["rbxassetid://3638767427"]=true }
        local function setup()
            local ch = safeChar()
            local hum = ch:FindFirstChildOfClass("Humanoid")
            if not hum then return end
            for _,track in pairs(hum:GetPlayingAnimationTracks()) do
                if track.Animation then
                    local id = track.Animation.AnimationId
                    local nm = track.Name:lower()
                    if blocked[id] or nm:match("punch") or nm:match("attack") or nm:match("right") then
                        track:Stop()
                    end
                end
            end
            hum.AnimationPlayed:Connect(function(track)
                if track.Animation then
                    local id = track.Animation.AnimationId
                    local nm = track.Name:lower()
                    if blocked[id] or nm:match("punch") or nm:match("attack") or nm:match("right") then
                        track:Stop()
                    end
                end
            end)
        end
        setup()
    end)
end

-- ===========================
-- TELEPORT
-- ===========================
local TP = Tabs.Teleport:CreateGroup("  Quick Teleports")
TP:AddButton("Spawn", function()
    safeChar():WaitForChild("HumanoidRootPart").CFrame = CFrame.new(-21, 18, -140) -- Ajusta si necesitas
    notify("Teletransporte","Teleported to Spawn",2)
end)
TP:AddButton("Brawl Lava", function()
    safeChar():WaitForChild("HumanoidRootPart").CFrame = CFrame.new(4471, 119, -8836)
    notify("Teletransporte","Teleported to Brawl Lava",2)
end)
TP:AddButton("Brawl Desert", function()
    safeChar():WaitForChild("HumanoidRootPart").CFrame = CFrame.new(960, 17, -7398)
    notify("Teletransporte","Teleported to Brawl Desert",2)
end)
TP:AddButton("Brawl Regular", function()
    safeChar():WaitForChild("HumanoidRootPart").CFrame = CFrame.new(-1849, 20, -6335)
    notify("Teletransporte","Teleported to Brawl Regular",2)
end)

-- ===========================
-- CREDITS
-- ===========================
local Credits = Tabs.Credits:CreateGroup("  Credits")
Credits:AddLabel("╭──────────────────────────╮")
Credits:AddLabel(" Script hecho por Isabella")
Credits:AddLabel("╰──────────────────────────╯")
Credits:AddLabel("")
Credits:AddLabel("User de Roblox: MissSherya")
Credits:AddLabel("Instagram: Sherya_Luck")
Credits:AddLabel("TikTok: Sherya6000")
Credits:AddLabel("Discord: isabella_hrz")
Credits:AddLabel("")
Credits:AddLabel("Thanks por usar el script")
Credits:AddLabel("Recomienda el script para más updates")
Credits:AddLabel("Hago peticiones de otros juegos")
Credits:AddLabel("Diviértete amiguito")
Credits:AddButton("Servidor Discord", function()
    setclipboard("https://discord.gg/rnDrhTZZCF")
    notify("Discord","Invitación copiada al portapapeles",3)
end)

-- ===========================
-- Save/Profile (opcional)
-- ===========================
SaveManager:SetLibrary(Library)
InterfaceManager:SetLibrary(Library)
SaveManager:IgnoreThemeSettings()
SaveManager:SetIgnoreIndexes({})
InterfaceManager:SetFolder("SheryaScript")
SaveManager:SetFolder("SheryaScript/GalaxyHub")
SaveManager:BuildConfigSection(Tabs.Main)
InterfaceManager:BuildInterfaceSection(Tabs.Main)
SaveManager:LoadAutoloadConfig()
